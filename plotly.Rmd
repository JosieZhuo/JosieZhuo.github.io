---
title: "plotly"
output: 
  html_document:
    toc: true
    toc_float: true
    theme: journal
---

### Let's look at NYC Restaruant Inspection dataset
```{r, include = FALSE}
library(tidyverse)
library(p8105.datasets)
library(plotly)
```

### Load, clean and filter the dataset
```{r}
data("rest_inspec")
inspec_data = 
  rest_inspec %>%
  janitor::clean_names() %>%
  select(boro, zipcode, street, cuisine_description, grade, score, grade_date) %>%
  drop_na(score)
```

### scatterplot
```{r}

inspec_data %>%
  filter(grade %in% c("A","B","C")) %>%
  filter(boro == "BRONX") %>%
  mutate(cuisine_description = fct_reorder(cuisine_description,score)) %>%
  plot_ly(
    x = ~cuisine_description, y = ~score, 
    color = ~grade , alpha = 0.5,
    type = "scatter", mode = "markers", colors = "viridis"
  )
```
The scatter plot shows the relationship between cuisine type and score in Bronx area.

### boxplot
```{r}

inspec_data %>%
  filter(zipcode == "10001") %>%
  mutate(street = fct_reorder(street, score)) %>%
  plot_ly(x = ~street, y = ~score,
          type = "box", color = ~street,
          colors = "viridis")
```
The boxplot shows the score distribution of restaurants in area where zipcode is 10001.

### histogram
```{r}
inspec_data %>%
  filter(grade %in% c("A", "B", "C"), !(boro == "Missing")) %>%
  mutate(
    boro = as.factor(boro),
    grade = as.factor(grade)
  ) %>% 
  group_by(boro, grade) %>% 
  count(boro, grade) %>% 
  plot_ly(
    x = ~boro, y = ~n, color = ~grade, type = "bar", colors = "viridis"
  )  
```
This histogram shows the distribution of grade in each boro.
